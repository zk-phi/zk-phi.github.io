<!doctypehtml><html lang="ja"><title>zk-phi の部屋 :: 最近の活動</title><meta charset="utf-8"><meta name="viewport"content="initial-scale=1"><meta name="description"content="zk-phi のホームページです"><link rel="preload"href="/fonts/DotGothic16-Regular.woff2"as="font"crossorigin><link rel="stylesheet"href="/css/font.css"><link rel="stylesheet"href="/css/common_critical.css"><link rel="stylesheet"href="/css/activity.css"><script defer src="/js/loader.js"></script><style></style><body id="body"><div id="content"><h1 id="title"><span class="rot">💻</span>最近の活動<span class="rot">💻</span></h1><p><a class="link"href="javascript:history.back()">&lt; 戻る</a><hr><div id="article"class="left"><h2 class="header">プログラミング / レビュー支援ツールの妄想 - zk_phi PUBLIC scrapbox - Scrapbox</h2><div class="right"><p>Scrapbox (2020/10/21)<a class="link"target="_blank"rel="noreferrer"href="https://scrapbox.io/zkphi/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0_%2F_%E3%83%AC%E3%83%93%E3%83%A5%E3%83%BC%E6%94%AF%E6%8F%B4%E3%83%84%E3%83%BC%E3%83%AB%E3%81%AE%E5%A6%84%E6%83%B3">See original</a></div><div id="cdata">Emacs 上で動くレビュー支援ツール<br><br><span><span>&nbsp;</span>コミット列 （大抵はブランチ） とmerge-baseのペアを対象に、レビューを開始できる</span><br><span><span>&nbsp;</span>レビューを中断して、保存・ロードできる</span><br><br><span><span>&nbsp;</span>コミット列の任意の連続する n 個のコミットについて、その開始時点と、終了時点の diff を見られる</span><br><br><span><span>&nbsp;</span>diff の、差分のある行のそれぞれについて、レビュー済みのマークを付けられる</span><br><span><span>&nbsp;&nbsp;</span>コミット列の中で A -&gt; B -&gt; C と変わっていった行について、 A -&gt; C の差分にレビュー済みのマークをつけるのは、 A -&gt; B, B -&gt; C それぞれにマークをつけるのと同じ</span><br><span><span>&nbsp;&nbsp;&nbsp;</span>(コミット間で hunk が合体したり分離したりしている場合にどうするかちゃんと考えたほうがよさそう)</span><br><span><span>&nbsp;&nbsp;</span>あるコミットの、全ての差分がレビュー済みになるとそのコミットはレビュー済みになる</span><br><span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>全てのコミットがレビュー済みになるとレビュー完了</span><br><br><span><span>&nbsp;</span>diff の、任意の行についてコメントを付けられる</span><br><span><span>&nbsp;&nbsp;</span>後で一覧できるとなおよい</span><br><br><span><span>&nbsp;</span>diff の +/- がハイライトされる</span><br><span><span>&nbsp;</span>言語自体のハイライトもあると嬉しい</span><br><br><span><span>&nbsp;</span>github 的な diff の expand もできると嬉しい</span><br><span><span>&nbsp;&nbsp;</span>閉じれるとなおよい</span><br><br><span><span>&nbsp;</span>その行がどのコミットで変わったか・変わるかがぱっとわかるといいかも (unified diff™)</span><br><br>code:txt<br><span><span>&nbsp;</span>1234</span><br><span><span>&nbsp;&nbsp;</span>+- hogehoge</span><br><span><span>&nbsp;&nbsp;&nbsp;</span>+ piyopiyo</span><br><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>hoge</span><br><span><span>&nbsp;</span>+ - fugafuga</span><br><span><span>&nbsp;&nbsp;&nbsp;</span>+- fugafuga</span><br><br><span>今見ているコミットが 3,</span><span>fugafuga</span><span>は 1 コミット目で追加されて、このコミットで修正されたけど、結局 4 コミット目でまた修正されることがわかる</span><br>→ 1 と 4 の diff を見ればよさそう<br><br><span><span>&nbsp;</span>side by side diff と切り替えられると良い</span><br><span><span>&nbsp;</span>コミットが追加されたときとか、 force push されたときどうするか？</span><br><br><span><span>&nbsp;</span>diff は都度取得ではなくて、レビュー開始時に一括で取得して、依存関係とか解析しておく必要がありそう</span><br><span><span>&nbsp;</span>各差分 (コミット, ファイル, 行, +/-) にユニークな ID を振れると扱いやすそう</span><br><br>hunkをごっそり移動した差分の扱い。「一つのコミットの中で、追加して一瞬で消した」という概念を導入すると。移動元をA、移動先をBとして、「AとBをhunkの移動としてレビュー済みマーク」すると、1. AとBに共通するコードはレビュー済みになる 2. Aだけに入っているコードはBに追加したあと一瞬で削除 3. Bだけに入ってるコードは新しく追加された行 と見倣わせる<br><br>簡単にシリアライズしたいので、レビューの進捗はバッファに直接書きたい<br><br>blameに飛べるとなお良い</div></div><hr><p><a class="link"href="javascript:history.back()">&lt; 戻る</a></div><script>const lazyScripts=["/js/prefetch.js","/js/stalker.js","/js/activity.js"],lazyStyles=["/css/common.css","/css/stalker.css"]</script>